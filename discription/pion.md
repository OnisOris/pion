# Класс `Pion`

Класс `Pion` предназначен для управления дроном через протокол MAVLink. Он включает функционал для инициализации соединения, отправки команд дрону, обработки сообщений, и управления движением. `Pion` также поддерживает многопоточность для выполнения различных задач параллельно.

---

## Основные возможности класса

1. **Инициализация соединения**:
   - Настраивает MAVLink-соединение между управляющим устройством и дроном.
   - Поддерживает управление через UDP.

2. **Управление дроном**:
   - Контролирует движение и ориентацию дрона.
   - Поддерживает команды взлёта, посадки, остановки, и задания скорости.

3. **Обработка сообщений**:
   - Обеспечивает приём и обработку данных от дрона, таких как координаты, скорость, и состояние.

4. **Многопоточность**:
   - Использует потоки для разделения задач: управление движением, обработка сообщений, и поддержание соединения.

5. **Мониторинг состояния**:
   - Позволяет следить за состоянием батареи и другими параметрами в реальном времени.

---

## Методы класса

### 1. **Инициализация MAVLink-соединения**
   - Устанавливает соединение с дроном.
   - Настраивает параметры связи (например, IP и порт для UDP).

---

### 2. **Методы управления дроном**

#### `arm`
**Описание**: Активирует дрон, включая его двигатели.

Пример:
```python
  drone.arm()
```

#### `disarm`

**Описание**: Деактивирует дрон, выключая двигатели.

Пример:
```
drone.disarm()
```


#### `takeoff`

**Описание**: Выполняет взлёт дрона.

Пример:

```  
drone.takeoff()
```

#### `land`

Описание: Выполняет посадку дрона.

Пример:

```
drone.land()
```

#### `send_speed`

Описание: Устанавливает вектор скорости дрона.
Аргументы:
    vx, vy, vz — компоненты скорости по осям.

Пример:

```
drone.send_speed(vx=1.0, vy=0.0, vz=0.5, yaw_rate=0.0)
```

#### `stop`

Описание: Останавливает движение дрона.

Пример:

```
drone.stop()
```

3. Обработка сообщений
#### `_send_heartbeat`

Описание: Отправляет сообщение HEARTBEAT для поддержания соединения.

Пример:

```
drone._send_heartbeat()
```

#### `handle_message`

Описание: Обрабатывает входящие сообщения от дрона, такие как обновления координат или состояния.
Пример:

drone.handle_message(message)


4. Многопоточность

Класс использует несколько потоков для выполнения различных задач:

Отправка команд: Поток для отправки управляющих сигналов.
Приём сообщений: Поток для обработки данных от дрона и для регулярной отправки HEARTBEAT.

# Примеры использования

```python
from pion import Pion
import sys
import time

args = sys.argv

number_drone = sys.argv[1]
drone = Pion(ip=f"10.1.100.{number_drone}", mavlink_port=5656)
drone.speed_flag = False
if '-c' in args:
    while True:
        print(drone.position)
        time.sleep(0)
else:
    print("---")
    drone.land()
    drone.arm()
    drone.takeoff()
    time.sleep(5)
    drone.set_v()
    drone.goto_from_outside(float(args[2]), float(args[3]), float(args[4]), float(args[5]))
    time.sleep(10)
    drone.land()
    drone.stop()
```
При запуске примера в качестве аргументов идут: номер дрона, координаты x, y, z, yaw
```commandline
python test.py [номер дрона] 1 1 1 0
```
Если необходимо протестировать получаемые с дрона координаты: поставить флаг -c
```commandline
python test.py [номер дрона] -с
```


# Задачи, решаемые Pion

Поддержание стабильного соединения с дроном.
Управление движением и ориентацией.
Обработка сообщений в реальном времени.
Сбор данных для анализа или дальнейшей обработки.

Этот класс является основой для систем автоматизации управления дроном и может быть расширен для более сложных сценариев, таких как выполнение траекторий или автономное управление.



